---
title: 容器與 Kubernetes 基礎
date: 2024-04-10 19:00:00 +0800
categories: [Software, Azure]
tags: [Azure, Cloud Service] 
excerpt: "容器和 Kubernetes 是現代應用程式開發和部署中非常重要的技術，特別是在雲端環境中。"
---

容器和 Kubernetes 是現代應用程式開發和部署中非常重要的技術，特別是在雲端環境中。下面是關於容器與 Kubernetes 的基礎知識介紹。

## **一、容器技術基礎**

### **1. 什麼是容器？**
   - **定義**：容器是一種輕量級、可攜帶的執行環境，它包含了應用程式的代碼及其所有依賴項（如庫、框架、配置文件等），使應用程式可以在任何環境下運行，而不會出現依賴缺失或環境不一致的問題。
   - **優點**：
     - **一致性**：無論在開發環境、測試環境還是生產環境，容器內的應用程式都能保證一致性。
     - **輕量級**：與虛擬機相比，容器不包含完整的操作系統，因此更加輕量，啟動速度快。
     - **隔離性**：容器之間相互隔離，應用程式在各自的容器內運行，不會干擾其他容器。

### **2. Docker 容器**
   - **Docker 簡介**：Docker 是當前最流行的容器化技術，提供了容器的構建、部署和運行環境。它允許開發者將應用程式及其依賴項打包到一個可執行的容器鏡像中，然後在任何支持 Docker 的環境中運行該容器。
   - **核心概念**：
     - **Docker 鏡像 (Image)**：Docker 鏡像是用於創建容器的模板，包含了應用程式及其依賴項。它是只讀的，可以在不同環境中重複使用。
     - **Docker 容器 (Container)**：容器是鏡像的運行實例，包含應用程式和運行所需的一切。
     - **Docker Hub**：這是一個公共的 Docker 鏡像倉庫，開發者可以從這裡拉取常用的鏡像，或將自己的鏡像上傳到這裡。

## **二、Kubernetes 基礎**

### **1. 什麼是 Kubernetes？**
   - **定義**：Kubernetes（通常簡稱為 K8s）是一個開源的容器編排平臺，最初由 Google 開發，用於自動化容器化應用程式的部署、擴展和管理。Kubernetes 能夠管理大規模的容器集群，並確保應用程式的高可用性、擴展性和靈活性。
   - **優點**：
     - **自動化運維**：Kubernetes 可以自動處理應用程式的部署、擴展、滾動更新和回滾，減少手動操作的錯誤風險。
     - **高可用性**：通過容器的自動重啟、替換和縮放，Kubernetes 保證應用程式在故障發生時仍能保持可用。
     - **可擴展性**：Kubernetes 能夠根據流量或資源使用情況動態調整應用程式的資源，從而優化運行成本。

### **2. Kubernetes 的核心組件**
   - **節點 (Node)**：Kubernetes 集群中的每個節點都是一台運行容器的機器。節點上運行著一個容器運行時（如 Docker）和 Kubernetes 的一些管理工具。
   - **Pod**：Pod 是 Kubernetes 中的最小部署單位，一個 Pod 可以包含一個或多個容器，這些容器共享網路命名空間和存儲卷。
   - **控制器 (Controller)**：控制器負責管理 Kubernetes 集群中的 Pod，比如 Deployment 控制器負責確保集群中有指定數量的 Pod 副本在運行。
   - **服務 (Service)**：服務是一種 Kubernetes 資源，用於定義一組 Pod 的網路訪問策略，通常用於暴露 Pod 的網路端點。
   - **命名空間 (Namespace)**：命名空間用於將 Kubernetes 集群中的資源分隔開來，通常用於多租戶環境或不同環境（如開發、測試和生產）之間的隔離。

### **3. Kubernetes 的運行機制**
   - **調度 (Scheduling)**：Kubernetes 的調度器負責將 Pod 分配到集群中的節點上運行。它會根據資源需求、節點狀態和其他約束條件來決定最佳的部署位置。
   - **滾動更新 (Rolling Update)**：當需要更新應用程式版本時，Kubernetes 支持滾動更新，即逐步替換老的 Pod 以實現應用程式的無中斷升級。
   - **自動擴展 (Auto Scaling)**：Kubernetes 可以根據 CPU 使用率或自定義指標自動調整 Pod 的副本數量，確保應用程式能夠應對變化的負載。

## **三、容器與 Kubernetes 的應用場景**

### **1. 微服務架構**
   - **容器與微服務**：在微服務架構中，每個服務都可以被打包到一個容器中，這些容器可以獨立部署、管理和擴展。Kubernetes 能夠協調這些容器的運行，確保微服務架構的穩定和擴展性。

### **2. CI/CD 管道**
   - **容器化的 CI/CD**：在持續集成和持續部署（CI/CD）過程中，容器可以用於統一開發、測試和生產環境，避免環境差異帶來的問題。Kubernetes 能夠自動部署和更新容器化應用程式，加速應用的發布周期。

### **3. 多雲和混合雲部署**
   - **跨雲容器編排**：Kubernetes 支持跨多個雲平臺和本地數據中心的容器編排，使得企業能夠靈活選擇和混合使用不同的雲服務提供商，實現更高的可用性和成本效益。

## **四、開始使用 Kubernetes**

### **1. 部署 Kubernetes 集群**
   - **Azure Kubernetes Service (AKS)**：Azure 提供了 Azure Kubernetes Service (AKS)，這是一種完全托管的 Kubernetes 服務。你可以通過 Azure Portal 或 Azure CLI 快速創建和管理 Kubernetes 集群。
   - **本地測試環境**：你可以使用工具如 Minikube 或 Kind 在本地電腦上設置一個 Kubernetes 測試環境，這樣可以在不使用雲服務的情況下學習和測試 Kubernetes。

### **2. 部署應用程式**
   - **編寫部署文件**：使用 YAML 文件定義 Kubernetes 資源（如 Deployment、Service），這些文件描述了應用程式的部署方式。
   - **部署應用**：使用 `kubectl apply -f <file-name>.yaml` 命令將應用程式部署到 Kubernetes 集群中，然後可以通過 Service 訪問應用程式。

### **3. 管理和監控**
   - **資源管理**：使用 `kubectl` 命令行工具管理 Kubernetes 資源，如查看 Pod 狀態、擴展副本數量、滾動更新等。
   - **監控和日誌**：使用 Prometheus、Grafana 等工具監控 Kubernetes 集群的健康狀況，並通過 Kubernetes 的日誌功能排查問題。

## **總結**

容器技術提供了一種輕量級、可移植的應用程式封裝方式，而 Kubernetes 則為容器的部署和管理提供了強大的編排能力。結合使用 Docker 和 Kubernetes，開發者可以構建、部署和管理大規模的分佈式應用程式，實現應用程式的高可用性、擴展性和自動化運維。隨著雲原生技術的普及，掌握容器和 Kubernetes 的基礎知識對於現代軟件開發和運維至關重要。
